
- name: Install postgres repo
  ansible.builtin.dnf:
    name: "https://download.postgresql.org/pub/repos/yum/reporpms/EL-9-x86_64/pgdg-redhat-repo-latest.noarch.rpm"
    state: present

# - name: Disable the built-in PostgreSQL module
#   ansible.builtin.shell: dnf module disable postgres -y

- name: Install PostgreSQL
  ansible.builtin.dnf:
    name: postgresql16-server
    state: present

- name: Initialize the PostgreSQL database
  ansible.builtin.command:
    cmd: /usr/pgsql-16/bin/postgresql-16-setup initdb
  args:
    creates: /var/lib/pgsql/16/data/PG_VERSION

- name: Enable PostgreSQL service
  ansible.builtin.systemd:
    name: postgresql-16
    enabled: yes

- name: Start PostgreSQL service
  ansible.builtin.systemd:
    name: postgresql-16
    state: started
